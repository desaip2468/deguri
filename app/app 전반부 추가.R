#Sys.setlocale("LC_CTYPE","ko_KR.UTF-8")

#install.packages("shinydashboard")

library(shiny)
library(shinydashboard)
library(tidyverse)

options(shiny.launch.browser = F, shiny.minified = F, shiny.port = 8300)
data<-read.csv('C:/Users/user/Desktop/2019-1/DATA/EMBRAIN/payments_ppdb_app_category_code_aggregated.csv')

ui <- dashboardPage(
  dashboardHeader(),
  dashboardSidebar(
    sidebarMenu(
      menuItem("FrontPage", tabName = "presentation_tab_0"),
      menuItem("1. ????????? ??????",
               menuSubItem("5060 ????????? ?????? ???????????? ?????????", "presentation_tab_1_1")
      ),
      menuItem("2. ????????? ??????/?????????",
               menuSubItem("????????? ?????? ???????????? ?????????", "presentation_tab_2_1"),
               menuSubItem("?????? ????????? ?????? ?????? ??????", "presentation_tab_2_2"),
               menuSubItem("???????????? ???????????? ??????", "presentation_tab_2_3"),
               menuSubItem("???????????? ?????????", "presentation_tab_2_4")
      ),
      menuItem("3. ?????? ?????? ??????",
               menuSubItem("K-medoids Clustering", "presentation_tab_3_1"),
               menuSubItem("Logistic Regression", "presentation_tab_3_2")
      ),
      menuItem("4. ?????? ?????? ??? ??????",
               menuSubItem("1. Closed Sweepstakes Strategy", "presentation_tab_4_1"),
               menuSubItem("2. Experience Marketing", "presentation_tab_4_2"),
               menuSubItem("3. Buyer & User Strategy", "presentation_tab_4_3")
      )
    )
  ),
  dashboardBody(
    tabItems(
      tabItem(
        tabName = "presentation_tab_0",
        h3("FrontPage")
      ),
      tabItem(
        tabName = "presentation_tab_1_1",
        h2("1. ????????? ??????"),
        h3("5060 ????????? ?????? ???????????? ?????????"),
        plotOutput("presentation_tab_1_1_plot"),
        br(), # Line break
        h4("??? ???????????????, ?????????????????????????????????????????????2030 ??????????????????, 5060 ??????????????????????????????????????????????????????
???????????????"),
        h4("??? ?????????5060 ????????????????????????, ???????????????????????????????????????????????????????????????????????????")
      ),
      tabItem(
        tabName = "presentation_tab_2_1",
        h2("2. ????????? ??????/?????????"),
        h3("????????? ?????? ???????????? ?????????"),
        plotOutput("presentation_tab_2_1_plot"),
        br(), # Line break
        h4("??? ????????????????????????????????????????????????????????? ?????????????????????????????????????????????"),
        h4("??? ????????? 'panel_id'??? ???????????? ???????????? aggregate ??????"),
        h4("??? ????????????????????????3???3???????????????????????????, ??????????????? ??????????????????????????? ???????????????????????????")
      ),
      tabItem(
        tabName = "presentation_tab_2_2",
        h2("2. ????????? ??????/?????????"),
        h3("????????? ?????? ???????????? ?????????"),
        plotOutput("presentation_tab_2_2_plot"),
        br(), # Line break
        h4("??? ????????? ????????? 5060 ????????? ???????????? ????????? ???????????? ????????????, ???????????? ???????????? ??????????????? ?????????"),
        h4("??? ?????? ??? ???????????? ?????? ?????? ????????? ???????????? ????????? ????????? ??????????????? ?????????"),
        h4("??? ??? ??????, ?????? ?????? ??? 3???3?????? ?????? ???????????????, ??? ???????????? ?????? ????????? ???????????? ?????? ????????? ????????????")
      ),
      tabItem(
        tabName = "presentation_tab_2_3",
        h2("2. ????????? ??????/?????????"),
        h3("???????????? ???????????? ??????"),
        #plotOutput("presentation_tab_2_3_plot"),
        br(), # Line break
        h4("??? 5060 ????????? ?????? ?????? ???????????? ?????? , ???????????? ???????????? ???????????? ??????????????? ??????"),
        h4("??? ?????? ?????? ???????????? ?????? ????????? Heavy User ??? ????????? Light User ??? ???????????? ?????? ????????? ??????")
              ),
      tabItem(
        tabName = "presentation_tab_2_4",
        h2("2. ????????? ??????/?????????"),
        h3("???????????? ?????????"),
        #plotOutput("presentation_tab_2_4_plot"),
        br(), # Line break
        h4("??? 5060 ????????? ?????? ?????? ???????????? ???????????? ????????? ???????????? ????????? , ?????? ?????? ?????????????????? ?????? ?????????
???????????? ??????????????? ??????????????? ?????? ??? ?????? ????????? ????????? ????????? ?????????"),
        h4("??? ?????? ?????? ???????????? ????????? ???????????? ?????? Class ??? ???????????? ????????? ???????????? ????????? ????????? ??? ??????"),
        h4("??? ????????? SMOTE ????????? ????????? ?????? ?????? ???????????? ????????? ??????????????? ???????????? ??????"),
        br(), # Line break,
        
        #plotOutput("presentation_tab_2_4_plot"),
        br(), # Line break
        h4("??? ????????? ???????????? ????????? 0??? ?????? ?????????, ????????? ????????? ????????? ???????????? ?????? ???????????????"),
        h4("??? ????????? ????????? ????????? ????????? ???????????? ????????? ???????????? ????????? 0??? ????????? ????????? ??????????????? ????????? ?????????")
      ),
      tabItem(
        tabName = "presentation_tab_3_1",
        h2("3. ?????? ?????? ??????"),
        h3("K-medoids clustering"),
        # plotOutput("presentation_tab_2_1_plot"),
        br(), # Line break
        h4("??? 2018??? 11????????? 2019??? 2???????????? ???????????????????????????????????????????????? 5060 ?????????????????????????????? ???"),
        h4("??? ??????????????????????????????????????????????????????????????? ?????????????????? ?????????, ???????????? ??????????????? ?????????????????????????????????
???????????? K-medoids clustering ??????????????????"),
        
        br(),
        # plotOutput("presentation_tab_2_1_plot"),
        br(), # Line break
        h4("??? 2?????? ?????? ?????? ?????? ?????? ????????? 0 ??? ????????? ???????????? ??? ???????????? , ??????????????? ???????????? ?????? ????????? ????????? ?????? 2 ?????? ??????
(Light User / Heavy ?????? ?????????"),
        h4("??? ?????? ?????? EDA ???????????? ?????????"),
        h4("??? ????????? ????????? ????????? ???????????? ??? ????????? ????????? ???????????? , ??? ????????? ???????????? ????????? ????????? ???????????? ?????????")
            ),
      tabItem(
        tabName = "presentation_tab_3_2",
        h2("3. ?????? ?????? ??????"),
        h3("Logistic Regression"),
        # plotOutput("presentation_tab_2_1_plot"),
        br(), # Line break
        h4("??? ????????? ???????????? ????????? ?????? ?????? ???????????? ?????? ????????? ???????????? ?????? ????????? ?????? , ?????? ?????? ?????? ????????? ?????? ????????? ?????? ???
????????? ?????? ????????? ?????????"),
        h4("??? ?????? ????????? ???????????? ??? ????????? ?????? ?????? ?????? ????????? ???????????? ????????? ???????????? , Accuracy ??? 0.72, ???????????? 0.94, ????????????
0.75 ??? ????????? ???????????????"),
        
        br(), # Line break
        # plotOutput("presentation_tab_2_1_plot"),
        br(), # Line break
        h4("??? ?????? ??????????????? ???????????? ?????? ??? ???????????? ?????? ??? ?????? ????????? ?????? ????????? ?????? ?????? ?????? ?????? ????????? ?????? ????????? ??????
???????????? ?????? ????????? ?????????"),
        h4("??? ?????? ????????? ???????????? ??? ????????? ?????? ?????? ?????? ????????? ???????????? ????????? ???????????? , Accuracy ??? 0.72, ???????????? 0.80, ????????????
0.43 ?????? ???????????? ????????? ?????? ?????? ????????? ???????????????")
      ),
      tabItem(
        tabName = "presentation_tab_4_1",
        h2("4. ?????? ?????? ??? ??????"),
        h3("1. Closed Sweepstakes Strategy"),
        plotOutput("presentation_tab_4_1_plot"),
        br(),
        h4("??? ??????????????? ?????? ??????????????? ?????? ????????? ?????? ???????????? ????????? ??????(?????? ????????? ????????? ??????)"),
        h4("????????????: 5060 ???????????? ?????????????????? ???????????? ???????????? making?????? ????????? ??? ????????? ??????????????? ??????????????? ?????????????????? ???????????? ?????? ????????? ????????????!"),       
        br(),
        h3("HOW?"),
        h3("Closed Sweepstakes Strategy(???????????????)"),
        h4("?????? '???????????? 5060' ????????? : ???????????? ????????? ?????? ???, ?????? ?????? ??????????????? 50?????? ?????? ????????? ???????????? ???????????? random ????????? ?????? 1??? ????????? ???????????? ??????????????? ????????? ?????? ???????????? ??????")
      ),
      
      tabItem(
        tabName = "presentation_tab_4_2",
        h2("4. ?????? ?????? ??? ??????"),
        h3("2. Experience Marketing"),
        plotOutput("presentation_tab_4_2_plot"), #2???
        br(),
        h4("??? [????????? ?????????, ??????/??????, ????????????, ?????????]??? ?????????????????? ?????? ????????? ??????????????? ??????" ),
        h4("??? ???????????? ??????, ???????????? ???????????? ??????????????? ??? ??????????????? ?????? ?????? ????????? ????????????."),
        h4("??? ?????????????????? ??????, [????????? ?????????, ?????????, ??????] ????????? ??????????????? ???????????? ??????????????? ????????? ????????? ??????"), 
        br(),
        plotOutput("presentation_tab_4_2_plot"),
        br(),
        h4("??? [??????, ??????/?????????, ??????, ?????????, ???????????????, ????????????] ?????? ??? ?????? ???????????????, ??? ??????????????? ????????? ???????????? ??????????????? ??? ?????? ????????????."),
        br(),
        plotOutput("presentation_tab_4_2_plot"),
        br(),
        h4("??? ???Heavy User??? ?????? , Light User ??? ??????????????? ?????? ?????? ????????? ?????? ????????? ?????? ????????? ?????? ???????????? ????????? ??????"),
        br(),
        plotOutput("presentation_tab_4_2_plot"),
        br(),
        h4("??? ?????? Heavy User ??? ??????????????? Light User ??? ?????? ??????,?????????,??????/?????? ?????? ?????? ????????? ?????? ????????? ?????? ??????"),
        #??? ?????? ?????? ?????? ????????? ??????
        br(),
        h3("??????"),
        h3("Heavy User??? 'Active Senior'??????."),
        h4("-> ????????? ????????? ????????? ???????????? ??????????????? ??????????????? ??????????????? ????????? 5060 ????????? ????????? ???. 
           ????????? ?????? ?????? ????????? ????????????, ????????? ?????? ????????? ?????? ?????? ????????? ???"),
        br(),
        h3("????????????"), 
        h3("5060???????????? ?????? ?????? ?????? ?????? ??????????????? ???????????? ????????????!"),
        h4("(???, '?????????'??? ????????? '?????????'??? ?????? ???????????? ?????? ???????????? Positioning)"),
        h3("How?"), 
        h4("??? ??? ????????? ??????????????? ???????????? ??????"),
        h4(": ?????????????????? Subbrand Create 'Active Pay'?????? ??? Activity Score??? ?????? ?????? ????????? ??????"),
        h4("-> ??????, ??????, ??????, ?????????, ????????? ?????? ????????? ??? ???????????? ????????? ?????? '????????? ?????????'??? ???????????? ??????"),
        h4("??? Experience marketing??? ?????? Nonuser ??????"),
        h4(": ??????????????? ?????? ?????? 5060??? "Active Pay"??? ?????? ???????????? ????????? ?????? ??????, 1??? ?????? ??????????????? ??????"),  
        h4("-> ???????????? ??????????????? ?????? ???????????? ?????? ????????? ????????? (?????? ???????????? ?????? ?????? ????????? ??????????????? ????????? ?????? ????????? ???????????? ?????? ???????????? ?????? ????????? ????????? ??????)"),
        h4("??? ???????????? ????????? ??????????????? ????????? '??????????????????' ?????? ?????? ????????? ?????? ???????????? ??????, UI????????? ??????, ????????? ?????? ??????, ??????????????? ?????? ???????????? 5060 ????????? ?????? ?????? -> '????????????'?????? ???
  ???)") 
        
      ),
      
      tabItem(
        tabName = "presentation_tab_4_3",
        h2("4. ?????? ?????? ??? ??????"),
        h3("3. Buyer & User Strategy"),
        plotOutput("presentation_tab_4_3_plot"),
        br(),
        h4("?????? 2 ????????? ?????? 1 ????????? ?????? ?????? ?????? ????????? ?????? ?????? ????????? ?????? ???????????? ????????? ??????"),
        h4("?????? ?????? ???????????? 5060 ????????? ?????? ????????? ??????????????? ???????????? ??? ????????? ??????????????? ?????? ????????? ????????? ???????????? ?????????
           ???????????? ??? ??? ??????"),
        h4("????????????: ???????????? ?????? ?????? ??????"),       
        br(),
        h3(HTML("HOW? <br/> 
                Buyer??? User??? ???????????? ????????? ?????? (User: ??????, Buyer: ?????????)")),
        h4("-> ????????? ?????? ????????? 5060 ???????????? ??????????????? ????????????, ????????? 10?????? ??????"),
        h4("-> ??????????????? ?????? ??? ??????????????? ????????? ??? ?????? ????????? ??????"), 
        h4("-> ??????????????? ???????????? ????????? 5060??? ???????????? ??????, ??????, ?????? ??????")
      )
      
      
      # tabItem(
      #   tabName = "presentation_tab_2_2",
      #   h3("2_2")
      # ),
      # tabItem(
      #   tabName = "plot_by_arbitrary_values",
      #   box(
      #     selectInput(
      #       "approval_store2",
      #       "????????? ?????? (100??? ????????? ?????????)",
      #       choices = c('??????', approval_stores)
      #     ),
      #     selectInput("field_x", "X??? ?????? (????????? ??????)", choices = simplePaymentsFieldDescription$Field),
      #     selectInput("field_y", "Y??? ?????? (????????? ?????? + ????????? ??????)", choices = allFieldsWithAgg)
      #   ),
      #   plotOutput(outputId = "xVersusYPlot")
      # )
    )
  )
)

server <- function(input, output) {
  output$presentation_tab_1_1_plot <- renderPlot({
    plot('mpg ~ cyl' %>% as.formula, data = mtcars)
  })
  
  output$presentation_tab_1_1_table <- renderTable({
    mtcars
  })
}

shinyApp(ui, server)